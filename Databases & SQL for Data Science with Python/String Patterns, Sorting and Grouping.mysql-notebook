{
    "type": "MySQLNotebook",
    "version": "1.0",
    "caption": "Script",
    "content": "CREATE DATABASE HR; \n\n#Create a blank database named ‘HR’. Use the script shared in the link below to create the required tables.\nCREATE TABLE EMPLOYEES (\n                            EMP_ID CHAR(9) NOT NULL, \n                            F_NAME VARCHAR(15) NOT NULL,\n                            L_NAME VARCHAR(15) NOT NULL,\n                            SSN CHAR(9),\n                            B_DATE DATE,\n                            SEX CHAR,\n                            ADDRESS VARCHAR(30),\n                            JOB_ID CHAR(9),\n                            SALARY DECIMAL(10,2),\n                            MANAGER_ID CHAR(9),\n                            DEP_ID CHAR(9) NOT NULL,\n                            PRIMARY KEY (EMP_ID));\n                            \n  CREATE TABLE JOB_HISTORY (\n                            EMPL_ID CHAR(9) NOT NULL, \n                            START_DATE DATE,\n                            JOBS_ID CHAR(9) NOT NULL,\n                            DEPT_ID CHAR(9),\n                            PRIMARY KEY (EMPL_ID,JOBS_ID));\n \n CREATE TABLE JOBS (\n                            JOB_IDENT CHAR(9) NOT NULL, \n                            JOB_TITLE VARCHAR(30),\n                            MIN_SALARY DECIMAL(10,2),\n                            MAX_SALARY DECIMAL(10,2),\n                            PRIMARY KEY (JOB_IDENT));\n\nCREATE TABLE DEPARTMENTS (\n                            DEPT_ID_DEP CHAR(9) NOT NULL, \n                            DEP_NAME VARCHAR(15) ,\n                            MANAGER_ID CHAR(9),\n                            LOC_ID CHAR(9),\n                            PRIMARY KEY (DEPT_ID_DEP));\n\nCREATE TABLE LOCATIONS (\n                            LOCT_ID CHAR(9) NOT NULL,\n                            DEP_ID_LOC CHAR(9) NOT NULL,\n                            PRIMARY KEY (LOCT_ID,DEP_ID_LOC));\n\n# \nSHOW VARIABLES LIKE 'secure_file_priv';\n\nLOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.2/Uploads/Departments.csv'\nINTO TABLE departments\nFIELDS TERMINATED BY ',';\n\nLOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.2/Uploads/Jobs.csv'\nINTO TABLE jobs\nFIELDS TERMINATED BY ',';\n\nLOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.2/Uploads/JobsHistory.csv'\nINTO TABLE job_history\nFIELDS TERMINATED BY ',';\n\nLOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.2/Uploads/Locations.csv'\nINTO TABLE locations\nFIELDS TERMINATED BY ',';\n\nLOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.2/Uploads/Employees.csv'\nINTO TABLE employees\nFIELDS TERMINATED BY ',' \nENCLOSED BY '\"';  \n\n# STRING Patterns\n# Say you need to retrieve the first names F_NAME and last names L_NAME of all employees who live in Elgin, IL. You can use the LIKE operator to retrieve strings that contain the said text. The code will look as shown below.\nSELECT F_NAME, L_NAME\nFROM EMPLOYEES\nWHERE ADDRESS LIKE '%Elgin,IL%';\n\n# Now assume that you want to identify the employees who were born during the 70s. The query above can be modified to:\nSELECT F_NAME, L_NAME\nFROM EMPLOYEES\nWHERE B_DATE LIKE '197%';\n\n# Consider a more specific example. Let us retrieve all employee records in department 5 where salary is between 60000 and 70000. The query that will be used is\nSELECT *\nFROM EMPLOYEES\nWHERE (SALARY BETWEEN 60000 AND 70000) AND DEP_ID = 5;\n\n# Sorting\n# Sorting is done using the ORDER BY clause in your SQL query. By default, the ORDER BY clause sorts the records in ascending order.\nSELECT F_NAME, L_NAME, DEP_ID \nFROM EMPLOYEES\nORDER BY DEP_ID;\n\n#Now, get the output of the same query in descending order of department ID, and within each deaprtment, the records should be ordered in descending alphabetical order by last name. For descending order, you can make use of the DESC clause.\nSELECT F_NAME, L_NAME, DEP_ID \nFROM EMPLOYEES\nORDER BY DEP_ID DESC, L_NAME DESC;\n\n# Grouping\n# A good example of grouping would be if For each department ID, we wish to retrieve the number of employees in the department.\nSELECT DEP_ID, COUNT(*)\nFROM EMPLOYEES\nGROUP BY DEP_ID;\n\n# Now, for each department, retrieve the number of employees in the department and the average employee salary in the department. For this, you can use COUNT(*) to retrieve the total count of a column, and AVG() function to compute average salaries, and then GROUP BY.\nSELECT DEP_ID, COUNT(*), AVG(SALARY)\nFROM EMPLOYEES\nGROUP BY DEP_ID;\n\n# You can refine your outut by using appropriate labels for the columns of data retrieved. Label the computed columns in the result set of the last problem as NUM_EMPLOYEES and AVG_SALARY.\nSELECT DEP_ID, COUNT(*) AS \"NUM_EMPLOYEES\", AVG(SALARY) AS \"AVG_SALARY\"\nFROM EMPLOYEES\nGROUP BY DEP_ID;\n\n# You can also combine the usage of GROUP BY and ORDER BY statements to sort the output of each group in accordance with a specific parameter. It is important to note that in such a case, ORDER BY clause muct be used after the GROUP BY clause. For example, we can sort the result of the previous query by average salary. The SQL query would thus become\nSELECT DEP_ID, COUNT(*) AS \"NUM_EMPLOYEES\", AVG(SALARY) AS \"AVG_SALARY\"\nFROM EMPLOYEES\nGROUP BY DEP_ID\nORDER BY AVG_SALARY;\n\n# In case you need to filter a grouped response, you have to use the HAVING clause. In the previous example, if we wish to limit the result to departments with fewer than 4 employees, We will have to use HAVING after the GROUP BY, and use the count() function in the HAVING clause instead of the column label.\nSELECT DEP_ID, COUNT(*) AS \"NUM_EMPLOYEES\", AVG(SALARY) AS \"AVG_SALARY\"\nFROM EMPLOYEES\nGROUP BY DEP_ID\nHAVING count(*) < 4\nORDER BY AVG_SALARY;\n\n#PRACTICE QUESTIONS\n# 1. Retrieve the list of all employees, first and last names, whose first names start with ‘S’.\n\nSELECT F_NAME, L_NAME\nFROM employees\nWHERE F_NAME LIKE 'S%';\n\n# 2. Arrange all the records of the EMPLOYEES table in ascending order of the date of birth.\n\nSELECT *\nFROM employees\nORDER BY B_DATE ASC;\n\n# 3. Group the records in terms of the department IDs and filter them of ones that have average salary more than or equal to 60000. Display the department ID and the average salary.\n\nSELECT DEP_ID, AVG(SALARY)\nFROM employees\nGROUP BY DEP_ID\nHAVING AVG(SALARY)>=60000;\n\n# 4. For the problem above, sort the results for each group in descending order of average salary.\nSELECT DEP_ID, AVG(SALARY)\nFROM employees\nGROUP BY DEP_ID\nHAVING AVG(SALARY)>=60000\nORDER BY AVG(SALARY) DESC;\n\n\n\n\n\n",
    "options": {
        "tabSize": 4,
        "indentSize": 4,
        "insertSpaces": true,
        "defaultEOL": "LF",
        "trimAutoWhitespace": true
    },
    "viewState": null,
    "contexts": [
        {
            "state": {
                "start": 1,
                "end": 155,
                "language": "mysql",
                "result": {
                    "type": "resultIds",
                    "list": [
                        "8596dd62-fac4-485a-96a8-d4c0be504d90"
                    ]
                },
                "currentHeight": 300,
                "currentSet": 1,
                "statements": [
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 0,
                            "length": 19
                        },
                        "contentStart": 0,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 19,
                            "length": 718
                        },
                        "contentStart": 130,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 737,
                            "length": 317
                        },
                        "contentStart": 769,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1054,
                            "length": 293
                        },
                        "contentStart": 1058,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1347,
                            "length": 286
                        },
                        "contentStart": 1349,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1633,
                            "length": 200
                        },
                        "contentStart": 1635,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1833,
                            "length": 44
                        },
                        "contentStart": 1838,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1877,
                            "length": 131
                        },
                        "contentStart": 1879,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2008,
                            "length": 117
                        },
                        "contentStart": 2010,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2125,
                            "length": 131
                        },
                        "contentStart": 2127,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2256,
                            "length": 127
                        },
                        "contentStart": 2258,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2383,
                            "length": 144
                        },
                        "contentStart": 2385,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2527,
                            "length": 316
                        },
                        "contentStart": 2774,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2843,
                            "length": 183
                        },
                        "contentStart": 2964,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 3026,
                            "length": 241
                        },
                        "contentStart": 3189,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 3267,
                            "length": 207
                        },
                        "contentStart": 3412,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 3474,
                            "length": 323
                        },
                        "contentStart": 3717,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 3797,
                            "length": 196
                        },
                        "contentStart": 3938,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 3993,
                            "length": 339
                        },
                        "contentStart": 4264,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 4332,
                            "length": 294
                        },
                        "contentStart": 4523,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 4626,
                            "length": 478
                        },
                        "contentStart": 4981,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 5104,
                            "length": 455
                        },
                        "contentStart": 5416,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 5559,
                            "length": 180
                        },
                        "contentStart": 5679,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 5739,
                            "length": 140
                        },
                        "contentStart": 5835,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 5879,
                            "length": 269
                        },
                        "contentStart": 6064,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 6148,
                            "length": 211
                        },
                        "contentStart": 6249,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 6359,
                            "length": 6
                        },
                        "contentStart": 6358,
                        "state": 3
                    }
                ]
            },
            "data": [
                {
                    "tabId": "2ae4f958-6d49-4e4f-b7db-2be77a6c145a",
                    "resultId": "8596dd62-fac4-485a-96a8-d4c0be504d90",
                    "rows": [
                        {
                            "0": "2\r",
                            "1": "86666.666667"
                        },
                        {
                            "0": "7\r",
                            "1": "66666.666667"
                        },
                        {
                            "0": "5\r",
                            "1": "65000.000000"
                        }
                    ],
                    "columns": [
                        {
                            "title": "DEP_ID",
                            "field": "0",
                            "dataType": {
                                "type": 17,
                                "characterMaximumLength": 65535,
                                "flags": [
                                    "BINARY",
                                    "ASCII",
                                    "UNICODE"
                                ],
                                "needsQuotes": true,
                                "parameterFormatType": "OneOrZero"
                            },
                            "inPK": false,
                            "nullable": false,
                            "autoIncrement": false
                        },
                        {
                            "title": "AVG(SALARY)",
                            "field": "1",
                            "dataType": {
                                "type": 10,
                                "flags": [
                                    "UNSIGNED",
                                    "ZEROFILL"
                                ],
                                "numericPrecision": 65,
                                "numericScale": 30,
                                "parameterFormatType": "TwoOrOneOrZero",
                                "synonyms": [
                                    "FIXED",
                                    "NUMERIC",
                                    "DEC"
                                ]
                            },
                            "inPK": false,
                            "nullable": false,
                            "autoIncrement": false
                        }
                    ],
                    "executionInfo": {
                        "text": "OK, 3 records retrieved in 1.527ms"
                    },
                    "totalRowCount": 3,
                    "hasMoreRows": false,
                    "currentPage": 0,
                    "index": 0,
                    "sql": "\n\n# 4. For the problem above, sort the results for each group in descending order of average salary.\nSELECT DEP_ID, AVG(SALARY)\nFROM employees\nGROUP BY DEP_ID\nHAVING AVG(SALARY)>=60000\nORDER BY AVG(SALARY) DESC;",
                    "updatable": false,
                    "fullTableName": ""
                }
            ]
        },
        {
            "state": {
                "start": 1,
                "end": 155,
                "language": "mysql",
                "currentSet": 1,
                "statements": [
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 0,
                            "length": 19
                        },
                        "contentStart": 0,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 19,
                            "length": 718
                        },
                        "contentStart": 130,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 737,
                            "length": 317
                        },
                        "contentStart": 769,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1054,
                            "length": 293
                        },
                        "contentStart": 1058,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1347,
                            "length": 286
                        },
                        "contentStart": 1349,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1633,
                            "length": 200
                        },
                        "contentStart": 1635,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1833,
                            "length": 44
                        },
                        "contentStart": 1838,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 1877,
                            "length": 131
                        },
                        "contentStart": 1879,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2008,
                            "length": 117
                        },
                        "contentStart": 2010,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2125,
                            "length": 131
                        },
                        "contentStart": 2127,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2256,
                            "length": 127
                        },
                        "contentStart": 2258,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2383,
                            "length": 144
                        },
                        "contentStart": 2385,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2527,
                            "length": 28
                        },
                        "contentStart": 2531,
                        "state": 0
                    },
                    {
                        "delimiter": ";",
                        "span": {
                            "start": 2555,
                            "length": 1
                        },
                        "contentStart": 2554,
                        "state": 3
                    }
                ]
            },
            "data": []
        }
    ]
}